<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اپلیکیشن آموزش اتاق عمل</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-blue: #0077b6;
            --light-blue: #90e0ef;
            --dark-blue: #023e8a;
            --background: #f0f4f8;
            --white: #ffffff;
            --text-dark: #333333;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --gray: #6c757d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0;
        }

        #main-page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .top-bar {
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .menu-btn, .exit-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px 10px;
        }

        .app-title {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .menu-card {
            background-color: var(--white);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .menu-card:hover {
            transform: translateY(-5px);
        }

        .menu-card i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--primary-blue);
        }

        .menu-card h2 {
            color: var(--primary-blue);
            margin-bottom: 10px;
        }

        .menu-card p {
            color: var(--gray);
        }

        .progress-section {
            background-color: var(--white);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .progress-item {
            margin-bottom: 15px;
        }

        .progress-bar {
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress {
            height: 100%;
            background: linear-gradient(to right, var(--light-blue), var(--primary-blue));
            border-radius: 5px;
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: var(--gray);
            background-color: var(--white);
            margin-top: 20px;
        }

        .side-menu {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100%;
            background-color: var(--white);
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }

        .side-menu.active {
            right: 0;
        }

        .menu-header {
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            color: white;
            padding: 20px;
            text-align: center;
        }

        .menu-items {
            flex: 1;
            padding: 0;
            overflow-y: auto;
        }

        .menu-item {
            padding: 15px 20px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .menu-item:hover {
            background-color: #f8f9fa;
        }

        .menu-item i {
            margin-left: 10px;
            color: var(--primary-blue);
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }

        .menu-overlay.active {
            display: block;
        }

        .page {
            display: none;
            min-height: 100vh;
            background-color: var(--background);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            z-index: 100;
        }

        .page.active {
            display: block;
        }

        .page-header {
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        .back-btn i {
            margin-right: 5px;
        }

        .page-content {
            padding: 20px;
            padding-bottom: 80px;
            overflow-y: auto;
        }

        .circles-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        @media (min-width: 768px) {
            .circles-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .circle-card {
            background: linear-gradient(135deg, var(--white), #f8f9fa);
            border-radius: 50%;
            width: 140px;
            height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin: 0 auto;
            padding: 15px;
            cursor: pointer;
            transition: transform 0.3s ease;
            position: relative;
        }

        .circle-card:hover {
            transform: scale(1.05);
        }

        .circle-card i {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary-blue);
        }

        .circle-card h3 {
            font-size: 0.9rem;
        }

        .step-number {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--primary-blue);
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .video-player-container {
            background-color: var(--white);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .video-wrapper {
            position: relative;
            width: 100%;
            padding-top: 56.25%;
            margin-bottom: 20px;
            background-color: #000;
            border-radius: 10px;
            overflow: hidden;
        }

        .video-wrapper video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 10px;
        }

        .video-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .video-controls button {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .video-info {
            margin-bottom: 20px;
        }

        .video-info h3 {
            color: var(--primary-blue);
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .btn {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            display: inline-block;
            text-align: center;
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        .card {
            background-color: var(--white);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }

        .card h3 {
            margin-bottom: 15px;
            color: var(--primary-blue);
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .quiz-container {
            background-color: var(--white);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            transition: background-color 0.5s ease;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .quiz-question {
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        .quiz-options {
            margin-bottom: 20px;
        }

        .quiz-option {
            padding: 12px 15px;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quiz-option:hover {
            background-color: #e9ecef;
        }

        .quiz-option.selected {
            background-color: var(--light-blue);
            border-color: var(--primary-blue);
        }

        .quiz-navigation {
            display: flex;
            justify-content: space-between;
        }

        .quiz-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
        }

        .quiz-btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.5s;
        }

        .notes-editor {
            width: 100%;
            height: 300px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            resize: vertical;
        }

        .contact-info {
            margin-bottom: 20px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }

        .contact-item i {
            margin-left: 10px;
            color: var(--primary-blue);
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0.8;
            animation: confetti-fall 3s ease-in-out forwards;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .celebration-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            animation: celebration-pulse 1.5s infinite;
            z-index: 2001;
        }

        @keyframes celebration-pulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        .celebration-firework {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            animation: firework-explode 1.5s ease-out forwards;
        }

        @keyframes firework-explode {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }

        .mission-content {
            line-height: 1.8;
            text-align: justify;
        }

        .mission-content p {
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- صفحه اصلی -->
        <div id="main-page" class="page active">
            <div class="top-bar">
                <button class="menu-btn" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="app-title">آموزش اتاق عمل</div>
                <button class="exit-btn" id="exit-app">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>

            <div class="main-content">
                <div class="menu-card" id="animations-btn">
                    <i class="fas fa-film"></i>
                    <h2>انیمیشن‌ها</h2>
                    <p>تماشای انیمیشن‌های آموزشی مراحل آماده‌سازی اتاق عمل</p>
                </div>
                
                <div class="menu-card" id="quiz-btn">
                    <i class="fas fa-clipboard-check"></i>
                    <h2>آزمون</h2>
                    <p>شرکت در آزمون‌های چهارگزینه‌ای برای سنجش دانش</p>
                </div>

                <div class="progress-section">
                    <h3>پیشرفت شما</h3>
                    <div class="progress-item">
                        <div>انیمیشن‌ها: <span id="animations-progress">0/8</span></div>
                        <div class="progress-bar">
                            <div class="progress" id="animations-progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <div>آزمون‌ها: <span id="quiz-progress">0/8</span></div>
                        <div class="progress-bar">
                            <div class="progress" id="quiz-progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer">
                علوم پزشکی همدان
            </div>
        </div>

        <!-- صفحه انیمیشن‌ها -->
        <div id="animations-page" class="page">
            <div class="page-header">
                <button class="back-btn" id="back-from-animations">
                    <i class="fas fa-arrow-right"></i> بازگشت
                </button>
                <div>انیمیشن‌های آموزشی</div>
                <div style="width: 80px;"></div>
            </div>
            
            <div class="page-content">
                <p>برای مشاهده هر درس، روی آن کلیک کنید:</p>
                
                <div class="circles-grid">
                    <div class="circle-card" data-lesson="1">
                        <div class="step-number">1</div>
                        <i class="fas fa-hands-wash"></i>
                        <h3>اسکراب کردن</h3>
                    </div>
                    <div class="circle-card" data-lesson="2">
                        <div class="step-number">2</div>
                        <i class="fas fa-hands"></i>
                        <h3>خشک کردن دست</h3>
                    </div>
                    <div class="circle-card" data-lesson="3">
                        <div class="step-number">3</div>
                        <i class="fas fa-user-md"></i>
                        <h3>پوشیدن گان</h3>
                    </div>
                    <div class="circle-card" data-lesson="4">
                        <div class="step-number">4</div>
                        <i class="fas fa-hand-paper"></i>
                        <h3>پوشیدن دستکش</h3>
                    </div>
                    <div class="circle-card" data-lesson="5">
                        <div class="step-number">5</div>
                        <i class="fas fa-procedures"></i>
                        <h3>پرپ کردن</h3>
                    </div>
                    <div class="circle-card" data-lesson="6">
                        <div class="step-number">6</div>
                        <i class="fas fa-bed"></i>
                        <h3>درپ کردن</h3>
                    </div>
                    <div class="circle-card" data-lesson="7">
                        <div class="step-number">7</div>
                        <i class="fas fa-tools"></i>
                        <h3>چیدمان ست جراحی</h3>
                    </div>
                    <div class="circle-card" data-lesson="8">
                        <div class="step-number">8</div>
                        <i class="fas fa-cut"></i>
                        <h3>استفاده از تیغ بیستوری</h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحه پخش ویدیو -->
        <div id="video-player-page" class="page">
            <div class="page-header">
                <button class="back-btn" id="back-from-video">
                    <i class="fas fa-arrow-right"></i> بازگشت
                </button>
                <div id="video-lesson-title">اسکراب کردن</div>
                <div style="width: 80px;"></div>
            </div>
            
            <div class="page-content">
                <div class="video-player-container">
                    <div class="video-info">
                        <h3 id="video-title">اسکراب کردن</h3>
                        <p id="video-description">اسکراب کردن فرآیند شستشوی دقیق دست و ساعد قبل از انجام عمل جراحی است که برای کاهش خطر عفونت انجام می‌شود.</p>
                    </div>
                    
                    <div class="video-wrapper">
                        <video id="educational-video" controls playsinline>
                            <source src="" type="video/mp4">
                            مرورگر شما از پخش ویدیو پشتیبانی نمی‌کند.
                        </video>
                    </div>
                    
                    <div class="video-controls">
                        <button id="play-pause-btn">
                            <i class="fas fa-play"></i> پخش
                        </button>
                        <div>
                            <span id="video-progress">پیشرفت: 0%</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3><i class="fas fa-edit"></i> یادداشت‌های شما</h3>
                    <textarea class="notes-editor" id="video-notes" placeholder="نکات مهم این درس را اینجا یادداشت کنید..."></textarea>
                    <button class="btn btn-block" id="save-video-notes">ذخیره یادداشت</button>
                </div>
            </div>
        </div>

        <!-- صفحه آزمون -->
        <div id="quiz-page" class="page">
            <div class="page-header">
                <button class="back-btn" id="back-from-quiz">
                    <i class="fas fa-arrow-right"></i> بازگشت
                </button>
                <div>آزمون‌های آموزشی</div>
                <div style="width: 80px;"></div>
            </div>
            
            <div class="page-content">
                <p>برای شرکت در آزمون هر درس، روی آن کلیک کنید:</p>
                
                <div class="circles-grid">
                    <div class="circle-card" data-quiz="1">
                        <div class="step-number">1</div>
                        <i class="fas fa-hands-wash"></i>
                        <h3>آزمون اسکراب کردن</h3>
                    </div>
                    <div class="circle-card" data-quiz="2">
                        <div class="step-number">2</div>
                        <i class="fas fa-hands"></i>
                        <h3>آزمون خشک کردن دست</h3>
                    </div>
                    <div class="circle-card" data-quiz="3">
                        <div class="step-number">3</div>
                        <i class="fas fa-user-md"></i>
                        <h3>آزمون پوشیدن گان</h3>
                    </div>
                    <div class="circle-card" data-quiz="4">
                        <div class="step-number">4</div>
                        <i class="fas fa-hand-paper"></i>
                        <h3>آزمون پوشیدن دستکش</h3>
                    </div>
                    <div class="circle-card" data-quiz="5">
                        <div class="step-number">5</div>
                        <i class="fas fa-procedures"></i>
                        <h3>آزمون پرپ کردن</h3>
                    </div>
                    <div class="circle-card" data-quiz="6">
                        <div class="step-number">6</div>
                        <i class="fas fa-bed"></i>
                        <h3>آزمون درپ کردن</h3>
                    </div>
                    <div class="circle-card" data-quiz="7">
                        <div class="step-number">7</div>
                        <i class="fas fa-tools"></i>
                        <h3>آزمون چیدمان ست</h3>
                    </div>
                    <div class="circle-card" data-quiz="8">
                        <div class="step-number">8</div>
                        <i class="fas fa-cut"></i>
                        <h3>آزمون تیغ بیستوری</h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحه پنل کاربری -->
        <div id="user-profile-page" class="page">
            <div class="page-header">
                <button class="back-btn" id="back-from-user-profile">
                    <i class="fas fa-arrow-right"></i> بازگشت
                </button>
                <div>پنل کاربری</div>
                <div style="width: 80px;"></div>
            </div>
            
            <div class="page-content">
                <div class="card">
                    <h3>اطلاعات شخصی</h3>
                    <div class="form-group">
                        <label for="first-name">نام</label>
                        <input type="text" id="first-name" class="form-control" placeholder="نام خود را وارد کنید">
                    </div>
                    <div class="form-group">
                        <label for="last-name">نام خانوادگی</label>
                        <input type="text" id="last-name" class="form-control" placeholder="نام خانوادگی خود را وارد کنید">
                    </div>
                    <div class="form-group">
                        <label for="field">رشته تحصیلی</label>
                        <input type="text" id="field" class="form-control" placeholder="رشته تحصیلی خود را وارد کنید">
                    </div>
                    <div class="form-group">
                        <label for="term">ترم</label>
                        <input type="number" id="term" class="form-control" placeholder="ترم تحصیلی خود را وارد کنید">
                    </div>
                    <button class="btn btn-block" id="save-profile">ذخیره اطلاعات</button>
                </div>

                <div class="card">
                    <h3>آمار و پیشرفت</h3>
                    <div class="progress-item">
                        <div>پیشرفت کلی: <span id="overall-progress">0%</span></div>
                        <div class="progress-bar">
                            <div class="progress" id="overall-progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <div>میانگین نمرات: <span id="average-score">0</span></div>
                    </div>
                </div>

                <div class="card">
                    <h3>نمرات آزمون‌ها</h3>
                    <div id="quiz-scores"></div>
                </div>
            </div>
        </div>

        <!-- صفحه دفترچه یادداشت -->
        <div id="notebook-page" class="page">
            <div class="page-header">
                <button class="back-btn" id="back-from-notebook">
                    <i class="fas fa-arrow-right"></i> بازگشت
                </button>
                <div>دفترچه یادداشت</div>
                <div style="width: 80px;"></div>
            </div>
            
            <div class="page-content">
                <textarea class="notes-editor" id="notes-editor" placeholder="یادداشت‌های خود را اینجا بنویسید..."></textarea>
                <button class="btn btn-block" id="save-notes" style="margin-top: 15px;">ذخیره یادداشت</button>
            </div>
        </div>

        <!-- صفحه اهداف ما -->
        <div id="mission-page" class="page">
            <div class="page-header">
                <button class="back-btn" id="back-from-mission">
                    <i class="fas fa-arrow-right"></i> بازگشت
                </button>
                <div>اهداف ما</div>
                <div style="width: 80px;"></div>
            </div>
            
            <div class="page-content">
                <div class="card">
                    <h3>درباره این پروژه</h3>
                    <div class="mission-content">
                        <p>این کار با همکاری گروه فناوری اطلاعات سلامت و اتاق عمل در دانشگاه علوم پزشکی همدان ایجاد شده است.</p>
                        <p>هدف اصلی این اپلیکیشن، ارائه آموزش‌های تخصصی و استاندارد برای دانشجویان و کارکنان اتاق عمل است تا بتوانند مهارت‌های لازم برای آماده‌سازی و مدیریت اتاق عمل را به صورت مؤثر فراگیرند.</p>
                        <p>ما معتقدیم که آموزش صحیح و استاندارد می‌تواند کیفیت خدمات ارائه شده در اتاق عمل را به طور قابل توجهی بهبود بخشد و در نهایت به ارتقای سلامت جامعه کمک کند.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحه ارتباط با ما -->
        <div id="contact-page" class="page">
            <div class="page-header">
                <button class="back-btn" id="back-from-contact">
                    <i class="fas fa-arrow-right"></i> بازگشت
                </button>
                <div>ارتباط با ما</div>
                <div style="width: 80px;"></div>
            </div>
            
            <div class="page-content">
                <div class="card">
                    <h3>راه‌های ارتباطی</h3>
                    <div class="contact-info">
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <span>surgilearn.medical@gmail.com</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>همدان، دانشگاه علوم پزشکی</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <span>0937075513</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحه آزمون فعال -->
        <div id="active-quiz-page" class="page">
            <div class="page-header">
                <button class="back-btn" id="back-from-active-quiz">
                    <i class="fas fa-arrow-right"></i> بازگشت
                </button>
                <div id="active-quiz-title">آزمون اسکراب کردن</div>
                <div style="width: 80px;"></div>
            </div>
            
            <div class="page-content">
                <div class="quiz-container" id="quiz-container">
                    <div class="quiz-header">
                        <h3 id="quiz-section-title">آزمون آموزشی</h3>
                        <div id="quiz-progress-text">سوال 1 از 10</div>
                    </div>
                    <div class="quiz-question">
                        <p id="quiz-question-text">کدام یک از موارد زیر جزء مراحل صحیح اسکراب جراحی محسوب می‌شود؟</p>
                    </div>
                    <div class="quiz-options" id="quiz-options">
                        <div class="quiz-option" data-option="0">شستن دست‌ها به مدت 2 دقیقه</div>
                        <div class="quiz-option" data-option="1">استفاده از برس ناخن قبل از شستشو</div>
                        <div class="quiz-option" data-option="2">شستشوی دست از نوک انگشتان به سمت آرنج</div>
                        <div class="quiz-option" data-option="3">خشک کردن دست با حوله معمولی</div>
                    </div>
                    <div class="quiz-navigation">
                        <button class="quiz-btn" id="prev-question" disabled>سوال قبل</button>
                        <button class="quiz-btn" id="next-question">سوال بعد</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- منوی کشویی -->
        <div class="menu-overlay" id="menu-overlay"></div>
        <div class="side-menu" id="side-menu">
            <div class="menu-header">
                <h3>منوی اصلی</h3>
                <p>اپلیکیشن آموزش اتاق عمل</p>
            </div>
            <div class="menu-items">
                <div class="menu-item" id="menu-user-profile">
                    <i class="fas fa-user"></i>
                    <span>پنل کاربری</span>
                </div>
                <div class="menu-item" id="menu-mission">
                    <i class="fas fa-bullseye"></i>
                    <span>اهداف ما</span>
                </div>
                <div class="menu-item" id="menu-notebook">
                    <i class="fas fa-book"></i>
                    <span>دفترچه یادداشت</span>
                </div>
                <div class="menu-item" id="menu-contact">
                    <i class="fas fa-envelope"></i>
                    <span>ارتباط با ما</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // داده‌های نمونه برای ویدیوها
        const videoData = {
            1: { title: "اسکراب کردن", description: "اسکراب کردن فرآیند شستشوی دقیق دست و ساعد قبل از انجام عمل جراحی است...", videoUrl: "scrub.mp4" },
            2: { title: "خشک کردن دست", description: "ابتدا با یک دست گوشه‌ای از حوله گرفته و آن را بردارید...", videoUrl: "drying.mp4" },
            3: { title: "پوشیدن گان", description: "گان بر روی لباس اسکراب پوشیده می‌شود تا فرد بتواند وارد محیط استریل شود...", videoUrl: "gowning.mp4" },
            4: { title: "پوشیدن دستکش", description: "در این مرحله، دست‌ها باید داخل آستین گان باقی بمانند...", videoUrl: "gloving.mp4" },
            5: { title: "پرپ کردن", description: "پرپ به معنای آماده‌سازی پوست جهت انجام جراحی است...", videoUrl: "prepping.mp4" },
            6: { title: "درپ کردن", description: "درپ کردن ناحیه جراحی یکی از مراحل حیاتی در حفظ استریلیتی و آماده‌سازی میدان جراحی است...", videoUrl: "draping.mp4" },
            7: { title: "چیدمان ست جراحی", description: "ابزارها بر اساس نوع عمل، ترتیب استفاده، و کاربردشان مرتب می‌شوند...", videoUrl: "setup.mp4" },
            8: { title: "استفاده از تیغ بیستوری", description: "ابتدا تیغ استریل را با پنس یا فورسپس از لبه بر می‌داریم...", videoUrl: "scalpel.mp4" }
        };

        // داده‌های نمونه برای آزمون با سوالات شما
        const quizData = {
            1: {
                title: "آزمون اسکراب کردن",
                questions: [
                    { text: "اسکراب از کدام ناحیه آغاز می‌شود؟", options: ["کف دست", "مچ", "نوک انگشتان و زیر ناخن‌ها", "پشت دست"], correctAnswer: 2 },
                    { text: "در اسکراب کردن، شست‌وشو تا کجا ادامه می‌یابد؟", options: ["تا مچ", "تا آرنج", "تا ۵ سانتی‌متر بالای آرنج", "تا شانه"], correctAnswer: 2 },
                    { text: "نوع حرکت در اسکراب باید چگونه باشد؟", options: ["رفت و برگشتی", "دایره‌ای", "ضربه‌ای", "خطی و بدون بازگشت"], correctAnswer: 3 },
                    { text: "مدت زمان معمول اسکراب کامل هر دو دست چقدر است؟", options: ["۲ تا ۳ دقیقه", "۵ تا ۷ دقیقه", "۱۰ دقیقه", "۱۵ دقیقه"], correctAnswer: 1 },
                    { text: "در مرحله آبکشی، جهت جریان آب باید چگونه باشد؟", options: ["از آرنج به انگشتان", "از انگشتان به آرنج", "به صورت دایره‌ای", "بدون جهت خاص"], correctAnswer: 1 },
                    { text: "چرا باید دست‌ها بالاتر از سطح آرنج نگه داشته شوند؟", options: ["برای خشک شدن سریع‌تر", "برای راحتی حرکت", "برای جلوگیری از آلودگی مجدد", "برای کاهش درد"], correctAnswer: 2 },
                    { text: "در مرحله آبکشی، چه نوع آبی استفاده می‌شود؟", options: ["آب سرد", "آب گرم", "آب ولرم", "آب مقطر"], correctAnswer: 2 },
                    { text: "در طول اسکراب، تماس با کدام موارد ممنوع است؟", options: ["حوله استریل", "شیر آب و لباس", "گان استریل", "میز جراحی"], correctAnswer: 1 },
                    { text: "محلول‌های رایج برای اسکراب کدام‌اند؟", options: ["الکل و آب", "کلرهگزیدین یا بتادین", "آب اکسیژنه", "صابون معمولی"], correctAnswer: 1 },
                    { text: "هدف اصلی از اسکراب کردن چیست؟", options: ["زیبایی پوست", "آماده‌سازی برای پوشیدن گان", "حذف میکروب‌ها و حفظ استریلیتی", "کاهش تعریق"], correctAnswer: 2 }
                ]
            },
            2: {
                title: "آزمون خشک کردن با حوله",
                questions: [
                    { text: "حوله باید ابتدا با کدام دست برداشته شود؟", options: ["با هر دو دست", "با دست مخالف", "با یک دست از گوشه حوله", "با پنس استریل"], correctAnswer: 2 },
                    { text: "چرا نباید قطرات آب از دست روی میز یا لباس بریزد؟", options: ["باعث خیس شدن لباس می‌شود", "باعث آلودگی محیط استریل می‌شود", "باعث لغزش حوله می‌شود", "باعث خستگی پرسنل می‌شود"], correctAnswer: 1 },
                    { text: "هنگام باز کردن حوله، چه کاری باید انجام شود؟", options: ["باز کردن با یک دست", "باز کردن از وسط حوله", "گرفتن گوشه‌ی مقابل با دست دیگر", "باز کردن با کمک سیرکولر"], correctAnswer: 2 },
                    { text: "خشک کردن دست و بازو باید با چه نوع حرکت انجام شود؟", options: ["رفت و برگشتی", "دایره‌ای", "ضربه‌ای از پایین به بالا", "چرخشی"], correctAnswer: 2 },
                    { text: "چرا باید کمی به سمت جلو خم شد؟", options: ["برای راحتی بیشتر", "برای جلوگیری از تماس حوله با لباس", "برای خشک شدن سریع‌تر", "برای کاهش درد"], correctAnswer: 1 },
                    { text: "برای خشک کردن دست دوم، باید از کدام قسمت حوله استفاده کرد؟", options: ["همان قسمت قبلی", "قسمت خشک و تمیز حوله", "وسط حوله", "لبه‌ی حوله"], correctAnswer: 1 },
                    { text: "گرفتن قسمت خشک حوله با کدام دست انجام می‌شود؟", options: ["با دست دارای حوله", "با دست مخالف", "با هر دو دست", "با پنس"], correctAnswer: 1 },
                    { text: "جهت حرکت در خشک کردن دست دوم چگونه است؟", options: ["از بالا به پایین", "از پایین به بالا", "از وسط به دو طرف", "به صورت دایره‌ای"], correctAnswer: 1 },
                    { text: "پس از پایان خشک کردن، حوله باید چگونه دور انداخته شود؟", options: ["روی میز", "در سطل معمولی", "بدون تماس با لباس اتاق عمل", "در جیب گان"], correctAnswer: 2 },
                    { text: "هدف اصلی از خشک کردن با حوله چیست؟", options: ["زیبایی پوست", "جلوگیری از خیس شدن لباس", "حفظ استریلیتی", "راحتی فرد اسکراب‌شده"], correctAnswer: 2 }
                ]
            },
            3: {
                title: "آزمون پوشیدن گان",
                questions: [
                    { text: "گان بر روی چه لباسی پوشیده می‌شود؟", options: ["لباس شخصی", "لباس بیمار", "لباس اسکراب", "لباس محافظ"], correctAnswer: 2 },
                    { text: "گان باید از کدام قسمت گرفته شود؟", options: ["وسط گان", "پایین آستین", "پایین یقه", "لبه پایینی"], correctAnswer: 2 },
                    { text: "هنگام باز کردن تای گان، چه نکته‌ای باید رعایت شود؟", options: ["تماس با بدن مجاز است", "گان باید با فاصله از بدن نگه داشته شود", "گان باید روی میز باز شود", "گان باید با کمک پرستار باز شود"], correctAnswer: 1 },
                    { text: "هنگام وارد کردن دست‌ها به آستین‌ها، چه نکته‌ای مهم است؟", options: ["تماس پوست با سطح خارجی گان مجاز است", "دست‌ها باید کاملاً داخل آستین باشند", "دست‌ها باید بیرون از آستین بمانند", "دست‌ها باید با کمک سیرکولر وارد شوند"], correctAnswer: 1 },
                    { text: "چه کسی بندهای پشت و کمری گان را می‌بندد؟", options: ["خود فرد اسکراب‌شده", "جراح", "فرد سیرکولر", "پرستار اتاق عمل"], correctAnswer: 2 },
                    { text: "هدف اصلی از پوشیدن گان چیست؟", options: ["زیبایی ظاهری", "محافظت از لباس اسکراب", "ورود به محیط استریل", "جلوگیری از تعریق"], correctAnswer: 2 },
                    { text: "تماس پوست با کدام قسمت ممنوع است؟", options: ["سطح داخلی گان", "سطح خارجی استریل گان", "بندهای گان", "یقه گان"], correctAnswer: 1 },
                    { text: "چرا گان باید به‌آرامی باز شود؟", options: ["برای جلوگیری از پارگی", "برای حفظ نظم", "برای جلوگیری از تماس با سطوح غیر استریل", "برای زیبایی"], correctAnswer: 2 },
                    { text: "گان باید به چه جهتی بلند شود؟", options: ["به سمت پایین", "به سمت جلو", "به سمت بالا", "به صورت چرخشی"], correctAnswer: 2 },
                    { text: "در صورت تماس پوست با سطح خارجی گان، چه اقدامی لازم است؟", options: ["ادامه دادن مراحل", "تعویض گان", "شست‌وشوی گان", "خشک کردن گان"], correctAnswer: 1 }
                ]
            },
            4: {
                title: "آزمون پوشیدن دستکش بسته",
                questions: [
                    { text: "در این مرحله، دست‌ها باید در کجا باقی بمانند؟", options: ["بیرون از آستین گان", "داخل آستین گان", "روی گان", "زیر لباس اسکراب"], correctAnswer: 1 },
                    { text: "کف دست‌ها باید چگونه قرار گیرند؟", options: ["رو به پایین", "به سمت هم", "رو به بالا", "به صورت مشت‌شده"], correctAnswer: 2 },
                    { text: "دستکش اول باید در چه موقعیتی نسبت به آستین قرار گیرد؟", options: ["زیر آستین", "روی سر آستین", "داخل آستین", "کنار آستین"], correctAnswer: 1 },
                    { text: "انگشتان دست و دستکش باید چگونه تنظیم شوند؟", options: ["به صورت خمیده", "در امتداد یکدیگر", "به صورت باز", "به سمت داخل"], correctAnswer: 1 },
                    { text: "از تماس با کدام قسمت دستکش باید خودداری شود؟", options: ["کف دستکش", "لبه‌ی دستکش", "پشت دستکش", "داخل دستکش"], correctAnswer: 1 },
                    { text: "برای پوشیدن دستکش اول، از کدام دست کمک گرفته می‌شود؟", options: ["دستی که آزاد است", "دستی که هنوز در آستین قرار دارد", "دستی که دستکش دارد", "دستی که سیرکولر نگه داشته"], correctAnswer: 1 },
                    { text: "دستکش دوم با کمک کدام دست پوشیده می‌شود؟", options: ["دستی که دستکش دارد", "دستی که هنوز در آستین است", "دستی که سیرکولر نگه داشته", "هر دو دست همزمان"], correctAnswer: 0 },
                    { text: "در پایان، چه کاری باید با دستکش‌ها انجام شود؟", options: ["شسته شوند", "مرتب شوند", "تعویض شوند", "خشک شوند"], correctAnswer: 1 },
                    { text: "در تمام مراحل، دست‌ها باید در چه موقعیتی قرار گیرند؟", options: ["پایین‌تر از سطح کمر", "هم‌سطح کمر", "بالاتر از سطح کمر", "کنار بدن"], correctAnswer: 2 },
                    { text: "هدف اصلی از پوشیدن دستکش بسته چیست؟", options: ["محافظت از پوست", "حفظ استریلیتی", "راحتی در حرکت", "جلوگیری از تعریق"], correctAnswer: 1 }
                ]
            },
            5: {
                title: "آزمون پرپ کردن",
                questions: [
                    { text: "پرپ به چه معناست؟", options: ["پوشاندن بیمار با درپ", "آماده‌سازی پوست برای جراحی", "ضدعفونی ابزار", "خشک کردن پوست"], correctAnswer: 1 },
                    { text: "قبل از شروع پرپ، چه اقدامی باید انجام شود؟", options: ["پوشیدن گان", "پوشیدن دستکش استریل", "پوشیدن ماسک", "چیدن ست"], correctAnswer: 1 },
                    { text: "محلول مورد استفاده در پرپ چیست؟", options: ["الکل سفید", "بتادین قهوه‌ای", "آب اکسیژنه", "کلرهگزیدین سبز"], correctAnswer: 1 },
                    { text: "جهت حرکت در پرپ چگونه است؟", options: ["از اطراف به مرکز", "از مرکز به اطراف", "رفت و برگشتی", "ضربه‌ای"], correctAnswer: 1 },
                    { text: "حرکت دست در پرپ باید چگونه باشد؟", options: ["سریع و چرخشی", "مالشی و ملایم", "ضربه‌ای", "رفت و برگشتی"], correctAnswer: 1 },
                    { text: "نقطه شروع پرپ کجاست؟", options: ["لبه‌ی محل جراحی", "نقطه‌ی انسزیون", "اطراف بدن", "محل قرارگیری درپ"], correctAnswer: 1 },
                    { text: "هدف اصلی از پرپ چیست؟", options: ["زیبایی پوست", "کاهش درد بیمار", "جلوگیری از عفونت", "آماده‌سازی لباس بیمار"], correctAnswer: 2 },
                    { text: "حرکت دست در پرپ باید به چه شکلی باشد؟", options: ["دایره‌وار", "خطی", "زیگزاگی", "تصادفی"], correctAnswer: 0 },
                    { text: "در صورت تماس دستکش با پوست غیر پرپ‌شده، چه اقدامی لازم است؟", options: ["ادامه دادن پرپ", "تعویض دستکش", "شست‌وشوی دستکش", "استفاده از الکل"], correctAnswer: 1 },
                    { text: "چرا نباید حرکت رفت و برگشتی انجام شود؟", options: ["باعث خستگی دست می‌شود", "باعث تحریک پوست می‌شود", "باعث انتقال آلودگی به مرکز محل جراحی", "باعث مصرف زیاد محلول می‌شود"], correctAnswer: 2 }
                ]
            },
            6: {
                title: "آزمون درپ کردن",
                questions: [
                    { text: "درپ کردن توسط چه کسی باید انجام شود؟", options: ["پرستار سیرکولر", "جراح بدون اسکراب", "فرد اسکراب‌شده با گان و دستکش استریل", "کمک‌جراح با لباس معمولی"], correctAnswer: 2 },
                    { text: "هدف اصلی از درپ کردن چیست؟", options: ["زیبایی میدان عمل", "جلوگیری از خونریزی", "حفظ استریلیتی", "راحتی بیمار"], correctAnswer: 2 },
                    { text: "درپ‌ها باید بر اساس چه چیزی انتخاب شوند؟", options: ["رنگ پوست بیمار", "نوع جراحی و ناحیه آناتومیک", "سلیقه جراح", "اندازه تخت"], correctAnswer: 1 },
                    { text: "در هنگام قرار دادن درپ، پارچه‌ها باید با کدام قسمت تماس داشته باشند؟", options: ["سطح داخلی گان", "پوست بیمار", "سطح استریل دستکش", "لباس پرستار"], correctAnswer: 2 },
                    { text: "درپ نباید با کدام موارد تماس داشته باشد؟", options: ["پوست پرپ‌شده", "سطح استریل میز", "لباس بیمار یا پوست غیر‌پرپ‌شده", "دستکش استریل"], correctAnswer: 2 },
                    { text: "درپ‌ها باید چگونه روی میدان عمل قرار گیرند؟", options: ["چین‌خورده", "نامنظم", "صاف، بدون چین‌خوردگی، و با ابعاد مناسب", "ضخیم و چندلایه"], correctAnswer: 2 },
                    { text: "درپ کردن در چه مرحله‌ای انجام می‌شود؟", options: ["قبل از اسکراب", "بعد از پرپ", "قبل از پوشیدن گان", "همزمان با چیدن ست"], correctAnswer: 1 },
                    { text: "در صورت تماس درپ با سطح غیر استریل، چه اقدامی لازم است؟", options: ["ادامه دادن جراحی", "تعویض درپ", "شست‌وشوی درپ", "استفاده از الکل"], correctAnswer: 1 },
                    { text: "چرا باید از چین‌خوردگی در میدان عمل جلوگیری شود؟", options: ["برای زیبایی", "برای جلوگیری از تجمع خون", "برای حفظ دید و دسترسی جراح", "برای کاهش هزینه"], correctAnswer: 2 },
                    { text: "درپ‌های استریل باید توسط چه کسی انتخاب شوند؟", options: ["فرد اسکراب‌شده", "بیمار", "پرستار سیرکولر", "مسئول پذیرش"], correctAnswer: 0 }
                ]
            },
            7: {
                title: "آزمون چیدن ست جراحی",
                questions: [
                    { text: "ابزارها بر اساس چه معیارهایی چیده می‌شوند؟", options: ["رنگ و اندازه", "نوع عمل، ترتیب استفاده، و کاربردشان", "سلیقه پرستار", "قیمت ابزارها"], correctAnswer: 1 },
                    { text: "در چیدمان ست جراحی، رعایت کدام اصل ضروری است؟", options: ["زیبایی ظاهری", "سرعت عمل", "استریلیتی", "صرفه‌جویی در ابزار"], correctAnswer: 2 },
                    { text: "تماس ابزارها با کدام موارد ممنوع است؟", options: ["میز استریل", "لباس، پوست، یا سطوح غیر استریل", "دستکش استریل", "گاز استریل"], correctAnswer: 1 },
                    { text: "چه کسی مسئول چیدمان صحیح ابزارهاست؟", options: ["پرستار سیرکولر", "فرد اسکراب‌شده", "جراح", "مسئول استریل"], correctAnswer: 1 },
                    { text: "ابزارها باید در چه موقعیتی نسبت به جراح و پرستار قرار گیرند؟", options: ["پشت سر آن‌ها", "خارج از محدوده دید", "در خط دید و محدوده‌ی حرکتی", "در گوشه اتاق"], correctAnswer: 2 },
                    { text: "هدف از چیدمان منظم ابزارها چیست؟", options: ["کاهش هزینه", "افزایش سرعت عمل و ایمنی", "زیبایی میز جراحی", "کاهش تعداد ابزار"], correctAnswer: 1 },
                    { text: "در صورت تماس ابزار با پوست یا لباس، چه اقدامی لازم است؟", options: ["استفاده مجدد", "شست‌وشو با آب", "تعویض یا استریل مجدد", "خشک کردن"], correctAnswer: 2 },
                    { text: "چرا ابزارها باید بر اساس ترتیب استفاده چیده شوند؟", options: ["برای زیبایی میز", "برای راحتی جراح در حین عمل", "برای کاهش تعداد ابزار", "برای آموزش دانشجویان"], correctAnswer: 1 },
                    { text: "ابزارها باید چگونه قرار گیرند؟", options: ["به‌صورت تصادفی", "به‌صورت فشرده و نامنظم", "مرتب، قابل دید و دسترسی", "درون بسته‌های درپ"], correctAnswer: 2 },
                    { text: "در چیدمان ست جراحی، چه چیزی نباید با ابزارها تماس داشته باشد؟", options: ["دستکش استریل", "میز استریل", "پوست و لباس فرد", "گاز استریل"], correctAnswer: 2 }
                ]
            },
            8: {
                title: "آزمون نحوه قرار دادن تیغ بیستوری",
                questions: [
                    { text: "تیغ بیستوری باید با چه ابزاری برداشته شود؟", options: ["دست مستقیم", "گاز استریل", "پنس یا فورسپس", "سرنگ"], correctAnswer: 2 },
                    { text: "هنگام گرفتن دسته بیستوری، شکاف تیغه‌خور باید در چه موقعیتی باشد؟", options: ["رو به پایین", "رو به داخل دست", "مقابل فرد", "پشت دست"], correctAnswer: 2 },
                    { text: "تیغ باید از کدام قسمت روی دسته قرار گیرد؟", options: ["از نوک تیز", "از وسط تیغ", "از قسمت پشتی دارای شکاف", "از لبه‌ی برنده"], correctAnswer: 2 },
                    { text: "زاویه قرارگیری تیغ روی دسته باید چگونه باشد؟", options: ["تصادفی", "عمودی", "مناسب و کنترل‌شده", "افقی"], correctAnswer: 2 },
                    { text: "فشار هنگام قرار دادن تیغ باید چگونه باشد؟", options: ["شدید و سریع", "نرم و کنترل‌شده", "ضربه‌ای", "بدون فشار"], correctAnswer: 1 },
                    { text: "تیغ پس از قرارگیری باید چگونه باشد؟", options: ["آزاد و قابل حرکت", "نیمه‌قفل", "کاملاً قفل شده و بدون تکان", "قابل جدا شدن سریع"], correctAnswer: 2 },
                    { text: "هدف از استفاده از پنس در برداشتن تیغ چیست؟", options: ["راحتی بیشتر", "جلوگیری از بریدگی دست", "زیبایی کار", "سرعت عمل"], correctAnswer: 1 },
                    { text: "در صورت عدم قفل شدن کامل تیغ، چه مشکلی ممکن است پیش بیاید؟", options: ["کند شدن تیغ", "لغزش تیغ در حین جراحی", "شکستن دسته", "کاهش استریلیتی"], correctAnswer: 1 },
                    { text: "در هنگام نصب تیغ، چه چیزی نباید لمس شود؟", options: ["لبه‌ی برنده تیغ", "شکاف دسته", "قسمت پشتی تیغ", "پنس"], correctAnswer: 0 },
                    { text: "پس از نصب تیغ، چه اقدامی باید انجام شود؟", options: ["تست برندگی تیغ", "بررسی قفل بودن تیغ روی دسته", "شست‌وشوی تیغ", "تعویض دسته"], correctAnswer: 1 }
                ]
            }
        };

        // وضعیت برنامه
        const appState = {
            currentPage: 'main-page',
            currentVideo: null,
            currentQuiz: null,
            currentQuestionIndex: 0,
            userAnswers: [],
            userProfile: { firstName: '', lastName: '', field: '', term: '' },
            progress: { animationsCompleted: 0, quizzesCompleted: 0, quizScores: {} },
            notes: '',
            videoNotes: {}
        };

        // بارگذاری داده‌ها از localStorage
        function loadAppState() {
            const savedState = localStorage.getItem('operatingRoomAppState');
            if (savedState) {
                Object.assign(appState, JSON.parse(savedState));
                updateProgressUI();
                updateUserProfileUI();
                updateNotesUI();
            }
        }

        // ذخیره داده‌ها در localStorage
        function saveAppState() {
            localStorage.setItem('operatingRoomAppState', JSON.stringify(appState));
        }

        // به روزرسانی UI پیشرفت
        function updateProgressUI() {
            document.getElementById('animations-progress').textContent = `${appState.progress.animationsCompleted}/8`;
            document.getElementById('animations-progress-bar').style.width = `${(appState.progress.animationsCompleted / 8) * 100}%`;
            
            document.getElementById('quiz-progress').textContent = `${appState.progress.quizzesCompleted}/8`;
            document.getElementById('quiz-progress-bar').style.width = `${(appState.progress.quizzesCompleted / 8) * 100}%`;
            
            const overallProgress = Math.round(((appState.progress.animationsCompleted + appState.progress.quizzesCompleted) / 16) * 100);
            document.getElementById('overall-progress').textContent = `${overallProgress}%`;
            document.getElementById('overall-progress-bar').style.width = `${overallProgress}%`;
            
            const scores = Object.values(appState.progress.quizScores);
            const averageScore = scores.length > 0 ? Math.round(scores.reduce((a, b) => a + b, 0) / scores.length) : 0;
            document.getElementById('average-score').textContent = averageScore;
            
            updateQuizScoresUI();
        }

        // به روزرسانی UI پروفایل کاربر
        function updateUserProfileUI() {
            document.getElementById('first-name').value = appState.userProfile.firstName;
            document.getElementById('last-name').value = appState.userProfile.lastName;
            document.getElementById('field').value = appState.userProfile.field;
            document.getElementById('term').value = appState.userProfile.term;
        }

        // به روزرسانی UI یادداشت‌ها
        function updateNotesUI() {
            document.getElementById('notes-editor').value = appState.notes;
            if (appState.currentVideo && appState.videoNotes[appState.currentVideo]) {
                document.getElementById('video-notes').value = appState.videoNotes[appState.currentVideo];
            }
        }

        // به روزرسانی UI نمرات آزمون‌ها
        function updateQuizScoresUI() {
            const quizScoresElement = document.getElementById('quiz-scores');
            quizScoresElement.innerHTML = '';
            
            const quizTitles = {
                1: 'اسکراب کردن', 2: 'خشک کردن دست', 3: 'پوشیدن گان', 4: 'پوشیدن دستکش',
                5: 'پرپ کردن', 6: 'درپ کردن', 7: 'چیدمان ست جراحی', 8: 'استفاده از تیغ بیستوری'
            };
            
            for (let i = 1; i <= 8; i++) {
                const score = appState.progress.quizScores[i] || '-';
                const scoreElement = document.createElement('div');
                scoreElement.className = 'progress-item';
                scoreElement.innerHTML = `<div>${quizTitles[i]}: <span>${score}/100</span></div>`;
                quizScoresElement.appendChild(scoreElement);
            }
        }

        // تغییر صفحه
        function showPage(pageId) {
            if (appState.currentPage === 'video-player-page') {
                const videoElement = document.getElementById('educational-video');
                videoElement.pause();
            }
            
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            document.getElementById(pageId).classList.add('active');
            appState.currentPage = pageId;
            closeMenu();
        }

        // مدیریت منوی کشویی
        function toggleMenu() {
            document.getElementById('side-menu').classList.toggle('active');
            document.getElementById('menu-overlay').classList.toggle('active');
        }

        function closeMenu() {
            document.getElementById('side-menu').classList.remove('active');
            document.getElementById('menu-overlay').classList.remove('active');
        }

        // پخش ویدیو
        function playVideo(lessonId) {
            appState.currentVideo = lessonId;
            const videoInfo = videoData[lessonId];
            
            if (!videoInfo) {
                alert('ویدیوی این درس در حال حاضر موجود نیست.');
                return;
            }
            
            document.getElementById('video-lesson-title').textContent = videoInfo.title;
            document.getElementById('video-title').textContent = videoInfo.title;
            document.getElementById('video-description').textContent = videoInfo.description;
            
            const videoElement = document.getElementById('educational-video');
            videoElement.innerHTML = `<source src="${videoInfo.videoUrl}" type="video/mp4">مرورگر شما از پخش ویدیو پشتیبانی نمی‌کند.`;
            videoElement.load();
            
            if (appState.videoNotes[lessonId]) {
                document.getElementById('video-notes').value = appState.videoNotes[lessonId];
            } else {
                document.getElementById('video-notes').value = '';
            }
            
            showPage('video-player-page');
            
            if (!appState.progress.animationsCompleted) {
                appState.progress.animationsCompleted = 1;
            } else if (appState.progress.animationsCompleted < 8) {
                appState.progress.animationsCompleted++;
            }
            
            saveAppState();
            updateProgressUI();
        }

        // شروع یک آزمون
        function startQuiz(quizId) {
            appState.currentQuiz = quizId;
            appState.currentQuestionIndex = 0;
            appState.userAnswers = [];
            
            document.getElementById('active-quiz-title').textContent = quizData[quizId].title;
            loadQuestion(0);
            showPage('active-quiz-page');
        }

        // بارگذاری سوال
        function loadQuestion(questionIndex) {
            const quiz = quizData[appState.currentQuiz];
            const question = quiz.questions[questionIndex];
            
            document.getElementById('quiz-progress-text').textContent = `سوال ${questionIndex + 1} از ${quiz.questions.length}`;
            document.getElementById('quiz-question-text').textContent = question.text;
            
            const optionsContainer = document.getElementById('quiz-options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option';
                optionElement.dataset.option = index;
                optionElement.textContent = option;
                
                if (appState.userAnswers[questionIndex] === index) {
                    optionElement.classList.add('selected');
                }
                
                optionElement.addEventListener('click', () => selectOption(index));
                optionsContainer.appendChild(optionElement);
            });
            
            document.getElementById('prev-question').disabled = questionIndex === 0;
            document.getElementById('next-question').textContent = questionIndex === quiz.questions.length - 1 ? 'پایان آزمون' : 'سوال بعد';
        }

        // انتخاب گزینه
        function selectOption(optionIndex) {
            const quiz = quizData[appState.currentQuiz];
            const question = quiz.questions[appState.currentQuestionIndex];
            
            appState.userAnswers[appState.currentQuestionIndex] = optionIndex;
            
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelector(`.quiz-option[data-option="${optionIndex}"]`).classList.add('selected');
            
            const isCorrect = optionIndex === question.correctAnswer;
            const quizContainer = document.getElementById('quiz-container');
            
            if (isCorrect) {
                quizContainer.style.backgroundColor = '#d4edda';
                createCelebration();
                setTimeout(() => { quizContainer.style.backgroundColor = ''; }, 1000);
            } else {
                quizContainer.style.backgroundColor = '#f8d7da';
                quizContainer.classList.add('shake');
                setTimeout(() => {
                    quizContainer.style.backgroundColor = '';
                    quizContainer.classList.remove('shake');
                }, 500);
            }
        }

        // ایجاد انیمیشن جشن
        function createCelebration() {
            const celebration = document.createElement('div');
            celebration.className = 'celebration';
            document.body.appendChild(celebration);
            
            const text = document.createElement('div');
            text.className = 'celebration-text';
            text.textContent = 'آفرین!';
            celebration.appendChild(text);
            
            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = getRandomColor();
                confetti.style.animationDelay = Math.random() * 2 + 's';
                celebration.appendChild(confetti);
            }
            
            for (let i = 0; i < 20; i++) {
                createFirework(celebration);
            }
            
            setTimeout(() => {
                document.body.removeChild(celebration);
            }, 3000);
        }

        // ایجاد آتش‌بازی
        function createFirework(container) {
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight / 2;
            
            for (let i = 0; i < 50; i++) {
                const firework = document.createElement('div');
                firework.className = 'celebration-firework';
                firework.style.left = x + 'px';
                firework.style.top = y + 'px';
                firework.style.backgroundColor = getRandomColor();
                
                const tx = (Math.random() - 0.5) * 200;
                const ty = (Math.random() - 0.5) * 200;
                firework.style.setProperty('--tx', tx + 'px');
                firework.style.setProperty('--ty', ty + 'px');
                
                container.appendChild(firework);
            }
        }

        // تولید رنگ تصادفی
        function getRandomColor() {
            const colors = ['#f94144', '#f3722c', '#f8961e', '#f9c74f', '#90be6d', '#43aa8b', '#577590', '#ff6b6b', '#48dbfb', '#ff9ff3'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // رفتن به سوال بعدی
        function nextQuestion() {
            const quiz = quizData[appState.currentQuiz];
            
            if (appState.currentQuestionIndex < quiz.questions.length - 1) {
                appState.currentQuestionIndex++;
                loadQuestion(appState.currentQuestionIndex);
            } else {
                finishQuiz();
            }
        }

        // رفتن به سوال قبلی
        function prevQuestion() {
            if (appState.currentQuestionIndex > 0) {
                appState.currentQuestionIndex--;
                loadQuestion(appState.currentQuestionIndex);
            }
        }

        // پایان آزمون
        function finishQuiz() {
            const quiz = quizData[appState.currentQuiz];
            let correctAnswers = 0;
            
            quiz.questions.forEach((question, index) => {
                if (appState.userAnswers[index] === question.correctAnswer) {
                    correctAnswers++;
                }
            });
            
            const score = Math.round((correctAnswers / quiz.questions.length) * 100);
            appState.progress.quizScores[appState.currentQuiz] = score;
            
            if (score > 0 && !appState.progress.quizzesCompleted) {
                appState.progress.quizzesCompleted = 1;
            } else if (score > 0 && appState.progress.quizzesCompleted < 8) {
                appState.progress.quizzesCompleted++;
            }
            
            saveAppState();
            updateProgressUI();
            
            alert(`آزمون به پایان رسید!\n\nنمره شما: ${score}/100\n\n${correctAnswers} از ${quiz.questions.length} سوال صحیح پاسخ داده شد.`);
            showPage('quiz-page');
        }

        // ذخیره پروفایل کاربر
        function saveUserProfile() {
            appState.userProfile.firstName = document.getElementById('first-name').value;
            appState.userProfile.lastName = document.getElementById('last-name').value;
            appState.userProfile.field = document.getElementById('field').value;
            appState.userProfile.term = document.getElementById('term').value;
            
            saveAppState();
            alert('اطلاعات کاربری با موفقیت ذخیره شد.');
        }

        // ذخیره یادداشت‌ها
        function saveNotes() {
            const notesContent = document.getElementById('notes-editor').value.trim();
            
            if (notesContent === '') {
                alert('شما چیزی ثبت نکردید. لطفاً چیزی بنویسید.');
                return;
            }
            
            appState.notes = notesContent;
            saveAppState();
            alert('یادداشت‌ها با موفقیت ذخیره شد.');
        }

        // ذخیره یادداشت‌های ویدیو
        function saveVideoNotes() {
            if (appState.currentVideo) {
                const videoNotesContent = document.getElementById('video-notes').value.trim();
                
                if (videoNotesContent === '') {
                    alert('شما چیزی ثبت نکردید. لطفاً چیزی بنویسید.');
                    return;
                }
                
                appState.videoNotes[appState.currentVideo] = videoNotesContent;
                saveAppState();
                alert('یادداشت‌های ویدیو با موفقیت ذخیره شد.');
            }
        }

        // مدیریت پخش ویدیو
        function setupVideoPlayer() {
            const video = document.getElementById('educational-video');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const playPauseIcon = playPauseBtn.querySelector('i');
            const progressText = document.getElementById('video-progress');
            
            video.addEventListener('play', function() {
                playPauseIcon.className = 'fas fa-pause';
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i> توقف';
            });
            
            video.addEventListener('pause', function() {
                playPauseIcon.className = 'fas fa-play';
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i> پخش';
            });
            
            video.addEventListener('timeupdate', function() {
                const progress = (video.currentTime / video.duration) * 100;
                progressText.textContent = `پیشرفت: ${Math.round(progress)}%`;
            });
            
            playPauseBtn.addEventListener('click', function() {
                if (video.paused) {
                    video.play();
                } else {
                    video.pause();
                }
            });
        }

        // خروج از برنامه
        function exitApp() {
            if (confirm('آیا از خروج از برنامه اطمینان دارید؟')) {
                // روش‌های مختلف برای خروج از اپلیکیشن
                if (typeof navigator !== 'undefined' && navigator.app) {
                    navigator.app.exitApp();
                } else if (typeof window !== 'undefined' && window.Capacitor && window.Capacitor.Plugins && window.Capacitor.Plugins.App) {
                    window.Capacitor.Plugins.App.exitApp();
                } else if (typeof window !== 'undefined' && window.android && typeof window.android.exitApp === 'function') {
                    window.android.exitApp();
                } else if (typeof window !== 'undefined' && window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.exitApp) {
                    window.webkit.messageHandlers.exitApp.postMessage({});
                } else if (typeof window !== 'undefined' && window.ReactNativeWebView) {
                    window.ReactNativeWebView.postMessage(JSON.stringify({type: 'EXIT_APP'}));
                } else if (typeof window !== 'undefined' && window.close) {
                    window.close();
                } else if (typeof window !== 'undefined' && window.history && window.history.length > 1) {
                    window.history.back();
                } else {
                    alert('با تشکر از استفاده شما از اپلیکیشن آموزش اتاق عمل\n\nبرای خروج، لطفاً دکمه بازگشت دستگاه خود را فشار دهید یا اپلیکیشن را از لیست برنامه‌های در حال اجرا ببندید.');
                }
            }
        }

        // راه‌اندازی برنامه
        function initializeApp() {
            loadAppState();
            
            document.getElementById('menu-toggle').addEventListener('click', toggleMenu);
            document.getElementById('menu-overlay').addEventListener('click', closeMenu);
            document.getElementById('exit-app').addEventListener('click', exitApp);
            
            document.getElementById('animations-btn').addEventListener('click', () => showPage('animations-page'));
            document.getElementById('quiz-btn').addEventListener('click', () => showPage('quiz-page'));
            
            document.getElementById('menu-user-profile').addEventListener('click', () => showPage('user-profile-page'));
            document.getElementById('menu-mission').addEventListener('click', () => showPage('mission-page'));
            document.getElementById('menu-notebook').addEventListener('click', () => showPage('notebook-page'));
            document.getElementById('menu-contact').addEventListener('click', () => showPage('contact-page'));
            
            document.getElementById('back-from-animations').addEventListener('click', () => showPage('main-page'));
            document.getElementById('back-from-quiz').addEventListener('click', () => showPage('main-page'));
            document.getElementById('back-from-user-profile').addEventListener('click', () => showPage('main-page'));
            document.getElementById('back-from-mission').addEventListener('click', () => showPage('main-page'));
            document.getElementById('back-from-notebook').addEventListener('click', () => showPage('main-page'));
            document.getElementById('back-from-contact').addEventListener('click', () => showPage('main-page'));
            document.getElementById('back-from-active-quiz').addEventListener('click', () => showPage('quiz-page'));
            document.getElementById('back-from-video').addEventListener('click', () => showPage('animations-page'));
            
            document.querySelectorAll('.circle-card[data-lesson]').forEach(card => {
                card.addEventListener('click', function() {
                    const lessonId = this.getAttribute('data-lesson');
                    playVideo(parseInt(lessonId));
                });
            });
            
            document.querySelectorAll('.circle-card[data-quiz]').forEach(card => {
                card.addEventListener('click', function() {
                    const quizId = this.getAttribute('data-quiz');
                    startQuiz(parseInt(quizId));
                });
            });
            
            document.getElementById('prev-question').addEventListener('click', prevQuestion);
            document.getElementById('next-question').addEventListener('click', nextQuestion);
            
            document.getElementById('save-profile').addEventListener('click', saveUserProfile);
            document.getElementById('save-notes').addEventListener('click', saveNotes);
            document.getElementById('save-video-notes').addEventListener('click', saveVideoNotes);
            
            setupVideoPlayer();
        }

        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
